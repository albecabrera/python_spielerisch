<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Python Lernen - Roblox Style</title>
    <script src="https://cdn.jsdelivr.net/npm/brython@3.12.0/brython.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3.12.0/brython_stdlib.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #111217 0%, #191b23 100%);
            color: #ffffff;
            overflow-x: hidden;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .top-bar {
            background: linear-gradient(to bottom, #2b2d33, #1f2024);
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #3a3c42;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .roblox-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            font-weight: 700;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #00a2ff 0%, #0066cc 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 2px 8px rgba(0, 162, 255, 0.4);
        }
        
        .player-stats {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .robux-display {
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #00a2ff 0%, #0066cc 100%);
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0, 162, 255, 0.3);
            animation: pulse 2s infinite;
        }
        
        .robux-icon {
            width: 24px;
            height: 24px;
            background: #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #0066cc;
        }
        
        .level-badge {
            background: linear-gradient(135deg, #ff6b00 0%, #ff3d00 100%);
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }
        
        .main-container {
            display: flex;
            height: calc(100vh - 55px);
        }
        
        .explorer-panel {
            width: 280px;
            background: #1f2024;
            border-right: 1px solid #3a3c42;
            overflow-y: auto;
        }
        
        .panel-header {
            background: #2b2d33;
            padding: 10px 15px;
            font-size: 13px;
            font-weight: 600;
            border-bottom: 1px solid #3a3c42;
        }
        
        .lesson-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #3a3c42;
            transition: all 0.2s;
        }
        
        .lesson-item:hover {
            background: rgba(0, 162, 255, 0.1);
        }
        
        .lesson-item.active {
            background: rgba(0, 162, 255, 0.2);
            border-left: 3px solid #00a2ff;
        }
        
        .workspace {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
        }
        
        .lesson-card {
            background: #2b2d33;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .lesson-title {
            font-size: 24px;
            color: #00a2ff;
            margin-bottom: 15px;
        }
        
        .code-editor {
            width: 100%;
            min-height: 200px;
            background: #111217;
            color: #e5e7eb;
            border: 1px solid #3a3c42;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            resize: vertical;
        }
        
        .editor-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .editor-btn {
            background: linear-gradient(135deg, #00a2ff 0%, #0066cc 100%);
            color: #ffffff;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .editor-btn:hover {
            transform: translateY(-2px);
        }
        
        .editor-btn.submit {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        }
        
        .output-panel {
            background: #0f1014;
            border: 1px solid #3a3c42;
            border-radius: 8px;
            padding: 15px;
            min-height: 100px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            color: #a8e063;
            white-space: pre-wrap;
        }
        
        .output-error {
            color: #ff6b9d;
        }
        
        .feedback-box {
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 8px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }
        
        .feedback-box.success {
            background: rgba(74, 222, 128, 0.2);
            border-left: 4px solid #4ade80;
        }
        
        .feedback-box.error {
            background: rgba(248, 113, 113, 0.2);
            border-left: 4px solid #f87171;
        }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2024; }
        ::-webkit-scrollbar-thumb { background: #3a3c42; border-radius: 4px; }
    </style>
</head>
<body onload="brython()">
    <div class="top-bar">
        <div class="roblox-logo">
            <div class="logo-icon">üêç</div>
            <span>Python Lernen - Roblox Style</span>
        </div>
        <div class="player-stats">
            <div class="level-badge">
                <span>‚≠ê Level <span id="playerLevel">1</span></span>
            </div>
            <div class="robux-display">
                <div class="robux-icon">R$</div>
                <span id="robuxCount">0</span>
            </div>
        </div>
    </div>

    <div class="main-container">
        <div class="explorer-panel">
            <div class="panel-header">üìö Lernwelten</div>
            <div id="lessonList"></div>
        </div>

        <div class="workspace">
            <div class="content-area" id="contentArea">
                <!-- Content wird dynamisch geladen -->
            </div>
        </div>
    </div>

    <script type="text/python">
from browser import document, window, html
import sys
from io import StringIO
import traceback

# Spieler-Daten
player_data = {
    'robux': 0,
    'level': 1,
    'completed': set()
}

# Lektionsdaten
LESSONS = {
    'lesson1': {
        'title': 'Dein erstes Programm',
        'world': 1,
        'reward': 100,
        'starter': '''print("Hallo Welt!")
print("Ich lerne Python!")
print("Das macht Spa√ü!")''',
        'check': lambda code, output: code.count("print(") >= 3
    },
    'lesson2': {
        'title': 'Variablen & Datentypen',
        'world': 1,
        'reward': 150,
        'starter': '''name = "Max"
alter = 14
print("Name:", name)
print("Alter:", alter)''',
        'check': lambda code, output: code.count("=") >= 3 and code.count("print(") >= 3
    },
    'lesson3': {
        'title': 'Rechnen mit Python',
        'world': 1,
        'reward': 150,
        'starter': '''a = 10
b = 5
summe = a + b
print("Summe:", summe)''',
        'check': lambda code, output: "+" in code or "*" in code
    },
    'lesson4': {
        'title': 'Strings & Text',
        'world': 1,
        'reward': 200,
        'starter': '''name = "Alex"
alter = 15
print(f"Ich bin {name} und {alter} Jahre alt")''',
        'check': lambda code, output: "f\"" in code or "f'" in code
    },
    'lesson5': {
        'title': 'Listen & Sammlungen',
        'world': 1,
        'reward': 200,
        'starter': '''fruechte = ["Apfel", "Banane"]
fruechte.append("Orange")
print(fruechte)''',
        'check': lambda code, output: "append(" in code
    },
    'lesson6': {
        'title': 'if/else Entscheidungen',
        'world': 2,
        'reward': 250,
        'starter': '''alter = 15
if alter >= 18:
    print("Erwachsen")
else:
    print("Jugendlich")''',
        'check': lambda code, output: "if" in code and "else" in code
    },
    'lesson7': {
        'title': 'Schleifen (for/while)',
        'world': 2,
        'reward': 300,
        'starter': '''for i in range(1, 6):
    print(f"Zahl: {i}")''',
        'check': lambda code, output: "for" in code and "range(" in code
    },
    'lesson8': {
        'title': 'Funktionen erstellen',
        'world': 2,
        'reward': 300,
        'starter': '''def gruesse(name):
    print(f"Hallo {name}!")

gruesse("Max")''',
        'check': lambda code, output: "def " in code and "return" in code or "def " in code
    },
    'lesson9': {
        'title': 'Module & Bibliotheken',
        'world': 2,
        'reward': 250,
        'starter': '''import random
zahl = random.randint(1, 10)
print("Zufallszahl:", zahl)''',
        'check': lambda code, output: "import" in code
    },
    'lesson10': {
        'title': 'Klassen & Objekte',
        'world': 3,
        'reward': 400,
        'starter': '''class Hund:
    def __init__(self, name):
        self.name = name
    def bellen(self):
        print(f"{self.name} bellt!")

mein_hund = Hund("Rex")
mein_hund.bellen()''',
        'check': lambda code, output: "class " in code and "__init__" in code
    },
    'lesson11': {
        'title': 'Dateien lesen/schreiben',
        'world': 3,
        'reward': 350,
        'starter': '''# Simuliert - Dateizugriff in Brython eingeschr√§nkt
print("Datei w√ºrde hier gespeichert")''',
        'check': lambda code, output: len(code) > 10
    },
    'lesson12': {
        'title': 'Eigene Spiele bauen',
        'world': 3,
        'reward': 500,
        'starter': '''import random
zahl = random.randint(1, 10)
print(f"Rate die Zahl zwischen 1-10!")
print(f"Die Zahl war: {zahl}")''',
        'check': lambda code, output: "import random" in code
    },

}

current_lesson = 'lesson1'

def play_success_sound():
    window.eval('''
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.frequency.value = 800;
        osc.type = 'sine';
        gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        osc.start(audioCtx.currentTime);
        osc.stop(audioCtx.currentTime + 0.5);
    ''')

def add_robux(amount):
    player_data['robux'] += amount
    document['robuxCount'].text = str(player_data['robux'])
    play_success_sound()

def load_lesson(lesson_id):
    global current_lesson
    if lesson_id not in LESSONS:
        return
    
    current_lesson = lesson_id
    lesson = LESSONS[lesson_id]
    
    content = f'''
        <div class="lesson-card">
            <h2 class="lesson-title">üéÆ {lesson['title']}</h2>
            <p style="color: #b4b7c2; margin-bottom: 20px;">
                Belohnung: ü™ô {lesson['reward']} Robux
            </p>
            
            <h3 style="color: #00a2ff; margin: 20px 0 10px 0;">üíª Code-Editor:</h3>
            <textarea class="code-editor" id="codeEditor">{lesson['starter']}</textarea>
            
            <div class="editor-buttons">
                <button class="editor-btn" onclick="runCode()">‚ñ∂Ô∏è Ausf√ºhren (F5)</button>
                <button class="editor-btn submit" onclick="checkSolution()">‚úÖ L√∂sung pr√ºfen</button>
                <button class="editor-btn" onclick="resetCode()">üîÑ Zur√ºcksetzen</button>
            </div>
            
            <h3 style="color: #00a2ff; margin: 20px 0 10px 0;">üìü Ausgabe:</h3>
            <div class="output-panel" id="output">Keine Ausgabe</div>
            
            <div class="feedback-box" id="feedback"></div>
        </div>
    '''
    
    document['contentArea'].html = content
    
    # Aktive Lektion markieren
    for item in document.select('.lesson-item'):
        item.classList.remove('active')
    try:
        document[f'lesson_{lesson_id}'].classList.add('active')
    except:
        pass

def run_code():
    code = document['codeEditor'].value
    output_div = document['output']
    
    old_stdout = sys.stdout
    sys.stdout = StringIO()
    
    try:
        exec(code)
        output = sys.stdout.getvalue()
        if output:
            output_div.html = output
            output_div.classList.remove('output-error')
        else:
            output_div.html = 'Keine Ausgabe'
    except Exception as e:
        error_msg = f"‚ùå Fehler: {str(e)}"
        output_div.html = error_msg
        output_div.classList.add('output-error')
    finally:
        sys.stdout = old_stdout

def check_solution():
    lesson = LESSONS[current_lesson]
    code = document['codeEditor'].value
    
    # F√ºhre Code aus f√ºr Output
    old_stdout = sys.stdout
    sys.stdout = StringIO()
    try:
        exec(code)
        output = sys.stdout.getvalue()
    except:
        output = ""
    finally:
        sys.stdout = old_stdout
    
    # Pr√ºfe L√∂sung
    try:
        is_correct = lesson['check'](code, output)
    except:
        is_correct = len(code.strip()) > 10
    
    feedback_div = document['feedback']
    
    if is_correct:
        if current_lesson not in player_data['completed']:
            player_data['completed'].add(current_lesson)
            add_robux(lesson['reward'])
            
            feedback_div.className = 'feedback-box success'
            feedback_div.html = f'''
                <div style="font-weight: 700; font-size: 16px; margin-bottom: 8px;">
                    üéâ Perfekt gel√∂st!
                </div>
                <div>Du hast {lesson['reward']} Robux verdient!</div>
            '''
        else:
            feedback_div.className = 'feedback-box success'
            feedback_div.html = '<div style="font-weight: 700;">‚úÖ Richtig!</div>'
    else:
        feedback_div.className = 'feedback-box error'
        feedback_div.html = '''
            <div style="font-weight: 700; margin-bottom: 8px;">‚ùå Noch nicht ganz</div>
            <div>Versuch es nochmal! Lies die Aufgabe genau.</div>
        '''
    
    feedback_div.style.display = 'block'

def reset_code():
    lesson = LESSONS[current_lesson]
    document['codeEditor'].value = lesson['starter']
    document['output'].html = 'Keine Ausgabe'
    document['feedback'].style.display = 'none'

def init():
    # Erstelle Lektionsliste
    worlds = {1: 'üå± Welt 1: Anf√§nger', 2: 'üî• Welt 2: Fortgeschritten', 3: 'üöÄ Welt 3: Profi'}
    lesson_list = document['lessonList']
    
    current_world = 0
    for lesson_id, lesson in LESSONS.items():
        if lesson['world'] != current_world:
            current_world = lesson['world']
            world_header = html.DIV(worlds[current_world], Class='panel-header')
            lesson_list <= world_header
        
        lesson_item = html.DIV(
            lesson['title'],
            Class='lesson-item',
            id=f'lesson_{lesson_id}'
        )
        lesson_item.bind('click', lambda e, lid=lesson_id: load_lesson(lid))
        lesson_list <= lesson_item
    
    # Lade erste Lektion
    load_lesson('lesson1')

# Keyboard shortcuts
def handle_keydown(event):
    if event.key == 'F5':
        event.preventDefault()
        run_code()
    elif event.ctrlKey and event.key == 'Enter':
        event.preventDefault()
        check_solution()

document.bind('keydown', handle_keydown)

# Globale Funktionen
window.runCode = run_code
window.checkSolution = check_solution
window.resetCode = reset_code

# Initialisiere
init()

# Willkommens-Nachricht
feedback = document['feedback']
feedback.className = 'feedback-box success'
feedback.html = '''
    <div style="font-weight: 700; font-size: 16px; margin-bottom: 8px;">
        üéÆ Willkommen bei Python!
    </div>
    <div>Beginne deine Lern-Reise und verdiene Robux! üöÄ</div>
'''
feedback.style.display = 'block'
    </script>
</body>
</html>
